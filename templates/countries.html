{% extends "_layout.html" %}

{# Navigation #}
{% set active_app = 'Countries' %}
{% set active_page = page %}

{% block title %}
  {{ super() }} - {{ page }}
{% endblock %}

{% block head %}
  {{ super() }}

  <link rel="stylesheet" href="/static/css/countries.css" />
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0/dist/Chart.min.js"></script>
  <script type="text/javascript" src="/static/js/main.js"></script>
{% endblock %}

{# Layout Menu #}
{% block menu %}
  {{ menu_item('All Countries', countries_url) }}
  {% for c in country_list %}
    {{ menu_item(c.label, c.url) }}
  {% endfor %}

  <select id='multipleSelect' multiple='multiple'>
      {% for x in country_list %}
        <option value="{{ x.label }}">{{ x.label }}</option>
      {% endfor %}
  </select>
  <script type='text/javascript'>
      $('#multipleSelect').val(['1', '2']);
  </script>


  
{% endblock %}

{% block content %}
  <h1>{{ page }}</h1>



    <canvas id="bar-chart"></canvas>

  {% for c in country_datas_list %}
      {{ menu_item(c.metric.name) }}

    <h2>Country : {{c.country.name}}  Number of Prisoners {{c.year}}: {{ c.value }}</h2>
    <h2>Region : {{c.country.region.name}} </h2>
  {% endfor %}

  {% for m in metric_list %}
   <button class="refreshmetric" type="button" data-key="{{ m.key }}">{{ m.label }}</button>
  {% endfor %}

  {% for c in country_list %}
  <button class="refresh" type="button" data-key="{{ c.key }}">{{ c.label }}</button>
 {% endfor %}




<!-- Resources -->
<script src="https://www.amcharts.com/lib/4/core.js"></script>
<script src="https://www.amcharts.com/lib/4/maps.js"></script>
<script src="https://www.amcharts.com/lib/4/geodata/worldLow.js"></script>
<script src="https://www.amcharts.com/lib/4/themes/animated.js"></script>

<!-- Chart code -->
<script>
am4core.ready(function() {

// Themes begin
am4core.useTheme(am4themes_animated);
// Themes end

// Create map instance
var chart = am4core.create("chartdiv", am4maps.MapChart);

// Set map definition
chart.geodata = am4geodata_worldLow;

// Set projection
chart.projection = new am4maps.projections.NaturalEarth1();

// Create map polygon series
var polygonSeries = chart.series.push(new am4maps.MapPolygonSeries());
polygonSeries.mapPolygons.template.strokeWidth = 0.5;

// Exclude Antartica
polygonSeries.exclude = ["AQ"];

// Make map load polygon (like country names) data from GeoJSON
polygonSeries.useGeodata = true;

// Configure series
var polygonTemplate = polygonSeries.mapPolygons.template;
polygonTemplate.tooltipText = "{name}";
polygonTemplate.fill = chart.colors.getIndex(0);

// Create hover state and set alternative fill color
var hs = polygonTemplate.states.create("hover");
hs.properties.fill = chart.colors.getIndex(2);

// Create active state
var activeState = polygonTemplate.states.create("active");
activeState.properties.fill = chart.colors.getIndex(4);

// Create an event to toggle "active" state
polygonTemplate.events.on("hit", function(ev) {
  ev.target.isActive = !ev.target.isActive;
  alert(ev.target.dataItem.dataContext.id)
})

chart.events.on("hit", function(ev) {
  
  
})



var graticuleSeries = chart.series.push(new am4maps.GraticuleSeries());

}); // end am4core.ready()
</script>

<!-- HTML -->
<div id="chartdiv"></div>


{% endblock %}