{% extends "_layout.html" %}

{# Navigation #}
{% set active_app = 'Countries' %}
{% set active_page = page %}

{% block title %}
  {{ super() }} - {{ page }}
{% endblock %}

{% block head %}
  {{ super() }}

  <link rel="stylesheet" href="/static/css/countries.css" />
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0/dist/Chart.min.js"></script>
{% endblock %}

{# Layout Menu #}
{% block menu %}
  {{ menu_item('All Countries', countries_url) }}
  {% for c in country_list %}
    {{ menu_item(c.label, c.url) }}
  {% endfor %}
{% endblock %}

{% block content %}
  <h1>{{ page }}</h1>

  {% if country %}
    <h2>Number of Idiots: {{ country.stat }}</h2>
  {% else %}
    <canvas id="bar-chart" width="800" height="450"></canvas>
    <script type="text/javascript">
      // Bar chart
      new Chart(document.getElementById("bar-chart"), {
          type: 'bar',
          data: {
            labels: [{% for c in country_list %}
                      '{{c.label}}',
                    {% endfor %}],
            datasets: [
              {
                label: "Population (idiots)",
                backgroundColor: [{% for c in country_list %}
                                    '{{c.colour}}',
                                  {% endfor %}],
                data: [{% for c in country_list %}
                        '{{c.stat}}',
                      {% endfor %}]
              }
            ]
          },
          options: {
            legend: { display: false },
            title: {
              display: true,
              text: 'Population (idiots)'
            }
          }
      });
  </script>
  {% endif %}
{% endblock %}